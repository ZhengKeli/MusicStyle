import librosa
import numpy as np


def extract_features(wave: np.array, sample_rate=22050):
    chroma_stft = librosa.feature.chroma_stft(wave, sample_rate)
    rms = librosa.feature.rms(y=wave)
    spec_cent = librosa.feature.spectral_centroid(wave, sample_rate)
    spec_bw = librosa.feature.spectral_bandwidth(wave, sample_rate)
    rolloff = librosa.feature.spectral_rolloff(wave, sample_rate)
    zcr = librosa.feature.zero_crossing_rate(wave)
    mfcc = librosa.feature.mfcc(wave, sample_rate)
    features = [chroma_stft, rms, spec_cent, spec_bw, rolloff, zcr, *mfcc]
    
    mean = [0.37866868321597574, 0.1309286197312176, 2201.8342257490885, 2242.5596132904925, 4571.702159056712,
            0.10363725784158571, -144.479170455724, 99.55219927203655, -8.92194891588576, 36.2930627335459,
            -1.1466270175147801, 14.634081958152354, -5.129623722522985, 10.119876023332589, -6.995751446947921,
            7.730250399836339, -6.0211207350972105, 4.471603926278651, -4.797231539811939, 1.781546992359683,
            -3.87027551315818, 1.1479881123004017, -3.9674305480618495, 0.5073029689239338, -2.328779132923577,
            -1.0948745662670116]
    scale = [0.08166487276357767, 0.0656523863365364, 715.603276565577, 526.0744281756166, 1573.982453481405,
             0.04181354681037818, 100.18552861757144, 31.31623459986889, 21.684164678731833, 16.65865109603917,
             12.216441450147338, 11.834879313551621, 9.93666604487106, 10.458856821156417, 8.280037927333003,
             7.934006901283375, 6.815608061970861, 6.71395269085035, 6.167832348241596, 5.00698357106314,
             4.871985652236352, 4.576819635866681, 4.548374123923036, 3.867153319274631, 3.7536959474281204,
             3.8356417863970056]
    
    for i, (m, s) in enumerate(zip(mean, scale)):
        features[i] = (np.mean(features[i]) - m) / s
    
    return features
